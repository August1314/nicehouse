# 智能监护模块测试清单

## 功能测试清单

### 基础功能测试

- [ ] **场景启动测试**
  - [ ] 运行游戏，Console 没有错误
  - [ ] MonitoringPanel UI 正常显示
  - [ ] 状态显示区域正常（State, Room, Duration）
  - [ ] 告警列表区域正常（可能为空）

- [ ] **数据底座集成测试**
  - [ ] PersonStateController.Instance 不为 null
  - [ ] AlarmManager.Instance 不为 null
  - [ ] DeviceManager.Instance 不为 null（如果使用灯光功能）

### 状态切换测试

- [ ] **Idle 状态**
  - [ ] 点击 "Idle" 按钮
  - [ ] State 显示更新为 "Idle"
  - [ ] Duration 开始计时

- [ ] **Walking 状态**
  - [ ] 点击 "Walking" 按钮
  - [ ] State 显示更新为 "Walking"

- [ ] **Sitting 状态**
  - [ ] 点击 "Sitting" 按钮
  - [ ] State 显示更新为 "Sitting"
  - [ ] Duration 正确计时

- [ ] **Bathing 状态**
  - [ ] 点击 "Bathing" 按钮
  - [ ] State 显示更新为 "Bathing"

- [ ] **Sleeping 状态**
  - [ ] 点击 "Sleeping" 按钮
  - [ ] State 显示更新为 "Sleeping"

- [ ] **Fallen 状态（紧急）**
  - [ ] 点击 "Fallen" 按钮
  - [ ] State 显示更新为 "Fallen"
  - [ ] 立即触发告警
  - [ ] 告警列表显示新告警

- [ ] **OutOfBed 状态（紧急）**
  - [ ] 点击 "OutOfBed" 按钮
  - [ ] State 显示更新为 "OutOfBed"
  - [ ] 立即触发告警

- [ ] **房间切换**
  - [ ] 使用下拉菜单切换房间
  - [ ] 状态切换时使用新房间ID

### 告警触发测试

- [ ] **跌倒告警（立即触发）**
  - [ ] 切换到 Fallen 状态
  - [ ] 告警立即触发
  - [ ] 告警类型为 "Fall/OutOfBed"
  - [ ] 告警列表显示
  - [ ] Console 显示告警日志
  - [ ] 灯光闪烁（如果有灯光设备）

- [ ] **久坐告警（超时触发）**
  - [ ] 设置 `Long Sitting Threshold` 为 0.1（分钟，用于快速测试）
  - [ ] 点击 "Sitting" 按钮
  - [ ] 等待 6 秒
  - [ ] 告警触发
  - [ ] 告警类型为 "Long Sitting"
  - [ ] 告警列表显示

- [ ] **久浴告警（超时触发）**
  - [ ] 设置 `Long Bathing Threshold` 为 0.1（分钟）
  - [ ] 点击 "Bathing" 按钮
  - [ ] 等待 6 秒
  - [ ] 告警触发
  - [ ] 告警类型为 "Long Bathing"

- [ ] **告警去重测试**
  - [ ] 触发同一类型告警
  - [ ] 在冷却期内（60秒）再次触发
  - [ ] 验证不会重复告警

### 告警处理测试

- [ ] **标记告警为已处理**
  - [ ] 触发一个告警
  - [ ] 在告警列表中点击 "Handle" 按钮
  - [ ] 告警状态更新为 "Handled"
  - [ ] 按钮变为不可点击
  - [ ] 告警颜色变为灰色

### 告警设置测试

- [ ] **修改久坐阈值**
  - [ ] 在输入框中输入新值（如 1）
  - [ ] 点击 "Apply Settings" 按钮
  - [ ] MonitoringController 的阈值更新

- [ ] **修改久浴阈值**
  - [ ] 在输入框中输入新值（如 0.5）
  - [ ] 点击 "Apply Settings" 按钮
  - [ ] MonitoringController 的阈值更新

- [ ] **启用/禁用监测**
  - [ ] 取消勾选 "Enable Monitoring" Toggle
  - [ ] 点击 "Apply Settings" 按钮
  - [ ] 验证告警不再触发
  - [ ] 重新勾选并应用
  - [ ] 验证告警恢复触发

### UI 更新测试

- [ ] **实时更新**
  - [ ] 状态持续时间实时更新
  - [ ] 告警列表实时更新（新告警出现时）

- [ ] **告警列表显示**
  - [ ] 告警项正确显示类型、房间、时间
  - [ ] 未处理告警显示为红色
  - [ ] 已处理告警显示为灰色
  - [ ] 列表可以滚动（如果告警很多）

### 告警响应测试（如果配置了）

- [ ] **音效播放**
  - [ ] 普通告警播放普通音效
  - [ ] 紧急告警（Fall）播放紧急音效

- [ ] **灯光闪烁**
  - [ ] 告警触发时房间灯光闪烁
  - [ ] 闪烁颜色正确（紧急=红色，普通=黄色）
  - [ ] 闪烁间隔正确

## 性能测试

- [ ] **帧率测试**
  - [ ] 运行游戏，保持 60 FPS
  - [ ] CPU 占用 < 5%

- [ ] **内存测试**
  - [ ] 长时间运行无内存泄漏
  - [ ] 告警记录数量限制正常（maxRecords = 100）

## 边界情况测试

- [ ] **空数据测试**
  - [ ] PersonStateController 为 null 时，不报错
  - [ ] AlarmManager 为 null 时，不报错

- [ ] **快速切换状态**
  - [ ] 快速点击多个状态按钮
  - [ ] 系统稳定，不崩溃

- [ ] **大量告警**
  - [ ] 触发超过 100 个告警
  - [ ] 验证只保留最近 100 条

## 集成测试

- [ ] **与环境智控模块集成**
  - [ ] 两个模块可以同时运行
  - [ ] 不冲突

- [ ] **与数据底座集成**
  - [ ] 所有数据接口调用正常
  - [ ] 数据同步正确

## 测试结果记录

**测试日期：** _______________

**测试人员：** _______________

**通过项：** ___ / ___

**失败项：** 
- [ ] 问题1：________________
- [ ] 问题2：________________

**备注：**
_________________________________________________

